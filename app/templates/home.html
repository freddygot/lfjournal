
{% extends "base.html" %}

{% block content %}
<div class="py-5 text-center">
    <h2>Welcome to the Psychologist Journal</h2>
    <p class="lead">This is a secure platform for psychologists to manage their patients.</p>
</div>
<div>
    <div id="calendar"></div>
</div>
<!-- Inkluder modalen her -->
{% include 'appointment_modal.html' %}
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
      var calendarEl = document.getElementById('calendar');
    
      var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        events: '/get_appointments', // Endepunkt for å hente avtaler
        dateClick: function(info) {
          // Åpne modalen for å legge til en avtale
          $('#appointmentDate').val(info.dateStr);
          $('#appointmentModal').modal('show');
        }
      });
    
      calendar.render();
    });
    </script>
    <script>
        $('#appointmentForm').on('submit', function(e) {
          e.preventDefault(); // Forhindre standard skjemainnsending
          // Samle data fra skjemaet
          var datetime = $('#appointmentDate').val();
          var description = $('#appointmentDescription').val();
          // Send data til serveren
          $.post('/add_appointment', {datetime: datetime, description: description}, function() {
            $('#appointmentModal').modal('hide'); // Lukk modalen
            calendar.refetchEvents(); // Oppdater kalenderen
          });
        });
        </script>
        
    
{% endblock %}
