{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div id='calendar'>
    <!-- Modal -->
<div class="modal fade" id="appointmentModal" tabindex="-1" aria-labelledby="appointmentModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="appointmentModalLabel">Ny Avtale</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Lukk">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form id="appointmentForm">
            <div class="form-group">
              <label for="patientName">Pasientnavn</label>
              <input type="text" class="form-control" id="patientName" required>
            </div>
            <div class="form-group">
              <label for="appointmentTime">Tidspunkt</label>
              <input type="datetime-local" class="form-control" id="appointmentTime" required>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Lukk</button>
          <button type="button" class="btn btn-primary" id="saveAppointment">Lagre Avtale</button>
        </div>
      </div>
    </div>
  </div>
  
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');
    var calendar = new FullCalendar.Calendar(calendarEl, {
      initialView: 'dayGridMonth',
      dateClick: function(info) {
        // Vis modal når en dato klikkes
        $('#appointmentTime').val(''); // Nullstill tidspunkt
        $('#patientName').val(''); // Nullstill pasientnavn
        $('#appointmentModal').modal('show');
        
        // Oppdater tidspunktet til valgt dato
        $('#appointmentTime').val(info.dateStr + 'T00:00');
      }
    });
    calendar.render();

    // Lagre avtale når "Lagre Avtale"-knappen klikkes
    document.getElementById('saveAppointment').addEventListener('click', function() {
        var patientName = document.getElementById('patientName').value;
        var appointmentTime = document.getElementById('appointmentTime').value;
        
        // Legg til avtale som en hendelse i kalenderen
        calendar.addEvent({
            title: patientName,
            start: appointmentTime,
            allDay: false // Eller true, avhengig av dine behov
        });
        
        // Lukk modal
        $('#appointmentModal').modal('hide');
    });
});
</script>
{% endblock %}
